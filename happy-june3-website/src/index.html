<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="styles/style.css">
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #232526 0%, #414345 100%);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            color: #fff;
        }
        header {
            text-align: center;
            padding: 2rem 1rem 1rem 1rem;
            background: transparent;
        }
        header h1 {
            color: #00ffe7;
            font-size: 2.8rem;
            letter-spacing: 2px;
            text-shadow: 0 0 16px #00ffe7, 0 0 32px #00ffe788;
            margin-bottom: 0.5rem;
            font-family: 'Orbitron', 'Segoe UI', Arial, sans-serif;
        }
        header p {
            color: #ff6f61;
            font-size: 1.2rem;
            font-weight: 500;
            text-shadow: 0 0 8px #ff6f6188;
        }
        .wheel-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 40px;
        }
        #icon-box {
            display: flex;
            gap: 24px;
            margin-bottom: 32px;
        }
        .icon-cell {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #232526 0%, #00ffe7 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5rem;
            box-shadow: 0 0 24px #00ffe7, 0 0 8px #fff inset;
            border: 3px solid #00ffe7;
            transition: background 0.3s, transform 0.2s, box-shadow 0.3s;
            user-select: none;
            color: #fff;
            text-shadow: 0 0 12px #00ffe7, 0 0 4px #fff;
            filter: drop-shadow(0 0 8px #00ffe7);
        }
        .icon-cell.active {
            background: linear-gradient(135deg, #ff6f61 0%, #ffe066 100%);
            transform: scale(1.18) rotate(-8deg);
            border-color: #ffe066;
            animation: bounce 0.6s;
            box-shadow: 0 0 32px #ffe066, 0 0 12px #ff6f61;
            color: #232526;
            text-shadow: 0 0 8px #ffe066, 0 0 2px #fff;
            filter: drop-shadow(0 0 8px #ffe066);
        }
        @keyframes bounce {
            0%   { transform: scale(1); }
            30%  { transform: scale(1.3) rotate(-8deg);}
            50%  { transform: scale(0.95) rotate(8deg);}
            70%  { transform: scale(1.15) rotate(-8deg);}
            100% { transform: scale(1.18) rotate(-8deg);}
        }
        #spinBtn {
            margin-top: 30px;
            padding: 1rem 2.5rem;
            font-size: 1.3rem;
            border-radius: 14px;
            border: none;
            background: linear-gradient(90deg, #00ffe7 0%, #232526 100%);
            color: #232526;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 24px #00ffe7, 0 4px 24px #232526;
            letter-spacing: 2px;
            text-transform: uppercase;
            transition: background 0.3s, transform 0.2s, color 0.2s;
        }
        #spinBtn:hover {
            background: linear-gradient(90deg, #ff6f61 0%, #ffe066 100%);
            color: #232526;
            transform: scale(1.09);
            box-shadow: 0 0 32px #ffe066, 0 4px 32px #ff6f61;
        }
        #result {
            margin-top: 28px;
            font-size: 1.5rem;
            color: #ffe066;
            font-weight: bold;
            min-height: 40px;
            text-align: center;
            text-shadow: 0 0 12px #ff6f61, 0 0 2px #fff;
            transition: color 0.3s, text-shadow 0.3s;
            white-space: pre-line;
        }
        .confetti {
            position: fixed;
            left: 0; top: 0; width: 100vw; height: 100vh;
            pointer-events: none;
            z-index: 9999;
        }
        .minigame-container {
            margin-top: 60px;
            text-align: center;
            animation: fadeInUp 1s;
        }
        #envelope-box {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 32px 0 18px 0;
        }
        .envelope {
            width: 80px;
            height: 100px;
            font-size: 3.5rem;
            background: linear-gradient(135deg, #ffe066 0%, #ff6f61 100%);
            border-radius: 18px;
            box-shadow: 0 0 24px #ffe066, 0 0 8px #ff6f61 inset;
            border: 3px solid #ff6f61;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.3s;
            user-select: none;
            position: relative;
        }
        .envelope.opened {
            animation: popOpen 0.5s;
            background: #fffbe7;
            color: #232526;
            box-shadow: 0 0 32px #ffe066, 0 0 12px #ff6f61;
        }
        @keyframes popOpen {
            0% { transform: scale(1);}
            60% { transform: scale(1.25);}
            100% { transform: scale(1);}
        }
        .envelope.disabled {
            pointer-events: none;
            opacity: 0.6;
        }
        #envelope-result {
            min-height: 40px;
            font-size: 1.3rem;
            color: #ff6f61;
            font-weight: bold;
            margin-top: 10px;
            text-shadow: 0 0 8px #ffe066;
        }
        .congrats-modal {
            background: rgba(0,0,0,0.85);
            position: fixed;
            left: 0; top: 0; width: 100vw; height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeIn 0.4s;
        }
        .congrats-content {
            background: linear-gradient(135deg, #ffe066 0%, #ff6f61 100%);
            border-radius: 18px;
            padding: 40px 60px;
            color: #232526;
            font-size: 2rem;
            font-weight: bold;
            box-shadow: 0 0 32px #ffe066, 0 0 12px #ff6f61;
            text-align: center;
            animation: popOpen 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0;}
            to { opacity: 1;}
        }
    </style>
</head>
<body>
    <header>
        <h1>Random Spin Game</h1>
        <p>Try your luck! Spin the wheel and see what you get!</p>
        <div id="score-box" style="margin-top:1rem;font-size:1.3rem;color:#ffe066;text-shadow:0 0 8px #00ffe7;">
            ƒêi·ªÉm c·ªßa b·∫°n: <span id="score">0</span>
        </div>
    </header>
    <main>
        <div class="wheel-container">
            <div id="icon-box" style="
                display: flex;
                gap: 18px;
                margin-bottom: 32px;
            ">
                <div class="icon-cell">üé≤</div>
                <div class="icon-cell">üé≤</div>
                <div class="icon-cell">üé≤</div>
            </div>
            <button id="spinBtn">Quay s·ªë</button>
            <div id="result"></div>
        </div>
        <div class="minigame-container">
            <h2 style="color:#ffe066;text-shadow:0 0 8px #ff6f61;">Mini Game: Ch·ªçn Phong Bao L√¨ X√¨</h2>
            <div id="envelope-box">
                <div class="envelope" data-index="0">üßß</div>
                <div class="envelope" data-index="1">üßß</div>
                <div class="envelope" data-index="2">üßß</div>
            </div>
            <div id="envelope-result"></div>
        </div>
    </main>
    <footer style="text-align:center; margin-top:40px; color:#00ffe7; font-size:1.1rem; letter-spacing:2px; text-shadow:0 0 8px #00ffe7;">
        ¬© 2025 zettezet
    </footer>
    <script>
        const icons = ["üçÄ", "üçé", "üçâ", "üçá", "üçã", "üçí", "‚≠ê", "üíé", "üéÅ", "üé≤", "üßß", "üçÄ"];
        const iconCells = document.querySelectorAll('.icon-cell');
        const spinBtn = document.getElementById('spinBtn');
        const result = document.getElementById('result');
        const scoreDisplay = document.getElementById('score');
        let intervals = [];
        let running = false;
        // L·∫•y ƒëi·ªÉm t·ª´ localStorage n·∫øu c√≥, n·∫øu kh√¥ng th√¨ l√† 0
        let score = Number(localStorage.getItem('score')) || 0;
        const scoreSpan = document.getElementById('score');
        scoreSpan.textContent = score;

        function updateScore(val) {
            score += val;
            if (score < 0) score = 0; // Kh√¥ng cho ƒëi·ªÉm √¢m
            scoreSpan.textContent = score;
            localStorage.setItem('score', score); // L∆∞u ƒëi·ªÉm v√†o localStorage
        }

        // Confetti effect
        function showConfetti() {
            const confetti = document.createElement('canvas');
            confetti.className = 'confetti';
            document.body.appendChild(confetti);
            const ctx = confetti.getContext('2d');
            confetti.width = window.innerWidth;
            confetti.height = window.innerHeight;
            let pieces = [];
            for (let i = 0; i < 80; i++) {
                pieces.push({
                    x: Math.random() * confetti.width,
                    y: Math.random() * -confetti.height,
                    r: Math.random() * 8 + 4,
                    d: Math.random() * 80 + 40,
                    color: `hsl(${Math.random()*360},90%,60%)`,
                    tilt: Math.random() * 10 - 10
                });
            }
            let angle = 0;
            function draw() {
                ctx.clearRect(0,0,confetti.width,confetti.height);
                angle += 0.01;
                for (let i = 0; i < pieces.length; i++) {
                    let p = pieces[i];
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.r, 0, 2 * Math.PI);
                    ctx.fillStyle = p.color;
                    ctx.fill();
                    p.y += Math.cos(angle + p.d) + 2 + p.r/2;
                    p.x += Math.sin(angle) * 2;
                    if (p.y > confetti.height) {
                        p.y = Math.random() * -20;
                        p.x = Math.random() * confetti.width;
                    }
                }
                if (angle < 2.5) requestAnimationFrame(draw);
                else setTimeout(()=>confetti.remove(), 800);
            }
            draw();
        }

        spinBtn.onclick = function () {
            if (running) return;
            running = true;
            result.textContent = '';
            spinBtn.disabled = true;

            // X√≥a hi·ªáu ·ª©ng c≈©
            iconCells.forEach(cell => cell.classList.remove('active'));

            // Quay t·ª´ng √¥
            intervals = [];
            let finalIcons = [];

            // TƒÉng t·ªâ l·ªá tr√πng 3 √¥: 2% x√°c su·∫•t s·∫Ω tr√πng c·∫£ 3
            let isTriple = Math.random() < 0.02;
            let tripleIcon = icons[Math.floor(Math.random() * icons.length)];

            iconCells.forEach((cell, idx) => {
                intervals[idx] = setInterval(() => {
                    const icon = icons[Math.floor(Math.random() * icons.length)];
                    cell.textContent = icon;
                }, 60 + idx * 30);
            });

            iconCells.forEach((cell, idx) => {
                setTimeout(() => {
                    clearInterval(intervals[idx]);
                    let icon;
                    if (isTriple) {
                        icon = tripleIcon;
                    } else {
                        icon = icons[Math.floor(Math.random() * icons.length)];
                    }
                    cell.textContent = icon;
                    cell.classList.add('active');
                    finalIcons[idx] = icon;
                    // Khi √¥ cu·ªëi c√πng d·ª´ng th√¨ hi·ªÉn th·ªã k·∫øt qu·∫£
                    if (idx === 2) {
                        setTimeout(() => {
                            result.style.transform = "scale(1.2)";
                            result.style.transition = "transform 0.3s";
                            result.textContent = `K·∫øt qu·∫£: ${finalIcons.join(' ')}`;
                            // N·∫øu c·∫£ 3 √¥ gi·ªëng nhau, t·∫∑ng qu√† ng·∫´u nhi√™n + confetti
                            if (finalIcons[0] === finalIcons[1] && finalIcons[1] === finalIcons[2]) {
                                const gifts = [
                                    "üéâ B·∫°n nh·∫≠n ƒë∆∞·ª£c 1 ph·∫ßn qu√† ƒë·∫∑c bi·ªát!",
                                    "üçÄ May m·∫Øn nh√¢n ƒë√¥i h√¥m nay!",
                                    "üéÅ Nh·∫≠n th√™m l∆∞·ª£t quay mi·ªÖn ph√≠!",
                                    "üíé Nh·∫≠n ƒë∆∞·ª£c vi√™n kim c∆∞∆°ng may m·∫Øn!",
                                    "‚≠ê B·∫°n l√† ng∆∞·ªùi c·ª±c k·ª≥ may m·∫Øn!"
                                ];
                                const gift = gifts[Math.floor(Math.random() * gifts.length)];
                                result.textContent += `\n${gift}`;
                                updateScore(10); // +10 ƒëi·ªÉm
                                showConfetti();
                            }
                            setTimeout(()=>{
                                result.style.transform = "scale(1)";
                            }, 400);
                            running = false;
                            spinBtn.disabled = false;
                        }, 300);
                    }
                }, 1800 + idx * 350);
            });
        };

        // Mini game logic
        const envelopes = document.querySelectorAll('.envelope');
        const envelopeResult = document.getElementById('envelope-result');
        let luckyIndex = Math.floor(Math.random() * 3);
        let found = false;

        envelopes.forEach((env, idx) => {
            env.onclick = function () {
                if (found || env.classList.contains('opened')) return;
                env.classList.add('opened', 'disabled');
                setTimeout(() => {
                    if (idx === luckyIndex) {
                        found = true;
                        showCongrats();
                    } else {
                        env.textContent = "üí£";
                        envelopeResult.textContent = "√îi kh√¥ng! B·∫°n ƒë√£ ch·ªçn ph·∫£i qu·∫£ bom! H√£y th·ª≠ l·∫°i v·ªõi phong bao kh√°c.";
                        updateScore(-3); // Tr·ª´ 3 ƒëi·ªÉm n·∫øu ch·ªçn ph·∫£i bom
                        setTimeout(() => {
                            resetEnvelopes();
                        }, 1000); // Sau 1 gi√¢y reset ƒë·ªÉ ch∆°i ti·∫øp
                    }
                }, 400);
            };
        });

        function showCongrats() {
            const modal = document.createElement('div');
            modal.className = 'congrats-modal';
            modal.innerHTML = `<div class="congrats-content">üéâ Xin ch√∫c m·ª´ng!<br>B·∫°n ƒë√£ ch·ªçn ƒë√∫ng l√¨ x√¨! üßß</div>`;
            document.body.appendChild(modal);
            setTimeout(() => {
                modal.onclick = () => {
                    modal.remove();
                    resetEnvelopes();
                };
            }, 800);
            envelopeResult.textContent = "";
            updateScore(5); // +5 ƒëi·ªÉm
        }

        function resetEnvelopes() {
            envelopes.forEach(e => {
                e.classList.remove('opened', 'disabled');
                e.textContent = "üßß";
            });
            luckyIndex = Math.floor(Math.random() * 3);
            found = false;
            envelopeResult.textContent = "";
        }
    </script>
</body>
</html>